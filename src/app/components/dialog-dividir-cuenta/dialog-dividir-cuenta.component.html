<div class="component-container">
    <button mat-icon-button class="close-button" (click)="onExitClick()">
        <mat-icon>close</mat-icon>
      </button>
      <br>
    <h2>División de Cuenta</h2>
    <br>
    <div *ngIf="mostrarPrimeraVista">
        <div class="button-row">
            <button (click)="onAddClick()">Nuevo Cuenta</button>
            <button  (click)="onShowClick()">Mostrar Pedido</button>
        </div>
        <br>
        <!-- Información de la mesa -->
        <div class="mesa-info">
            <span>  Mesa Nº: {{ mesaSelected.Descripcion + ' ' + mesaSelected.Numero }}</span>
            <span>Total: {{ sumaGranTotal | currency }}</span>
            <span>ICBPER: {{ sumaImpuestoBolsa | currency }}</span>
        </div>
    </div>

    <!-- Primera vista: Mostrar pedido completo -->
    <div *ngIf="mostrarPrimeraVista" class="grids-container">
        <!-- Botones de acciones principales -->


        <!-- Grilla Izquierda: Pedido completo -->
        <div class="grid">
            <h3>Cuentas</h3>
            <table mat-table [dataSource]="distinctPedidos" class="mat-elevation-z8">
                <ng-container matColumnDef="NombreCuenta">
                    <th mat-header-cell *matHeaderCellDef> Cliente </th>
                    <td mat-cell *matCellDef="let element"> {{ element.NombreCuenta }} </td>
                </ng-container>

                <ng-container matColumnDef="NroCuenta">
                    <th mat-header-cell *matHeaderCellDef> NroCuenta </th>
                    <td mat-cell *matCellDef="let element"> {{ element.NroCuenta }} </td>
                </ng-container>
                <ng-container matColumnDef="Actions">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button color="accent" matTooltip="Eliminar" (click)="EliminarCuenta(element)">
                            <mat-icon>delete</mat-icon>
                        </button>
                </ng-container>


                <tr mat-header-row *matHeaderRowDef="displayedColumnsCuenta"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumnsCuenta;" (click)="selectCuenta(row)"
                    [class.selected-row]="selectedRowCuenta === row"></tr>
            </table>
        </div>

        <!-- Grilla Derecha: Productos del pedido seleccionado -->
        <div class="grid">
            <h3>Productos</h3>
            <table mat-table [dataSource]="productosPedidoCuenta" class="mat-elevation-z8">
                <ng-container matColumnDef="Producto">
                    <th mat-header-cell *matHeaderCellDef> Producto </th>
                    <td mat-cell *matCellDef="let element"> {{ element.NombreCorto }} </td>
                </ng-container>

                <ng-container matColumnDef="Cantidad">
                    <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                    <td mat-cell *matCellDef="let element"> {{ element.Cantidad }} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>
    </div>

    <!-- Segunda vista: Modificar cuentas -->
    <div *ngIf="mostrarSegundaVista" class="modify-accounts-view">
        <div class="grids-container">
            <!-- Grilla Izquierda: Productos de la cuenta original -->
            <div class="grid">
                <h3>{{nombreCuentaOrigen}}</h3>
                <h3>Productos en Cuenta Origen</h3>
                <table mat-table [dataSource]="pedidoCuentaOrigen" class="mat-elevation-z8">
                    <ng-container matColumnDef="Producto">
                        <th mat-header-cell *matHeaderCellDef> Producto </th>
                        <td mat-cell *matCellDef="let element"> {{ element.NombreCorto }} </td>
                    </ng-container>

                    <ng-container matColumnDef="Cantidad">
                        <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                        <td mat-cell *matCellDef="let element"> {{ element.Cantidad }} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="moverProducto(row)"
                        [class.selected-row]="selectedRowOrigen === row"></tr>
                </table>
            </div>
            <!-- Grilla Derecha: Nueva cuenta -->
            <div class="grid">
                <h3>{{nombreCuentaDestino}}</h3>
                <h3>Nueva Cuenta</h3>
                <table mat-table [dataSource]="productosNuevaCuenta" class="mat-elevation-z8">
                    <ng-container matColumnDef="Producto">
                        <th mat-header-cell *matHeaderCellDef> Producto </th>
                        <td mat-cell *matCellDef="let element"> {{ element.NombreCorto }} </td>
                    </ng-container>

                    <ng-container matColumnDef="Cantidad">
                        <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                        <td mat-cell *matCellDef="let element"> {{ element.Cantidad }} </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="removerProducto(row)"
                        [class.selected-row]="selectedRowDestino === row"></tr>
                </table>
            </div>
        </div>

        <!-- Botones de Aceptar y Cancelar -->
        <div class="button-row">
            <button  (click)="onAcceptClick()">Aceptar</button>
            <button (click)="onCancelClick()">Cancelar</button>
        </div>
    </div>
</div>