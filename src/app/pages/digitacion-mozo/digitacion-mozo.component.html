<div class="container">
  <!-- Primera Columna -->
  <div class="column-left">
    <div class="top-section">
         <!-- Primera fila: Turno y Pedido -->
        <div class="info-row">
          <div *ngIf="turnoAbierto">
            <label>Turno: {{ turnoAbierto.NroTurno }} - OPEN </label>
            <br>
            <label>Pedido: {{ turnoAbierto.NroPedido }}</label>
          </div>
        </div>
        
        <!-- Segunda fila: Fecha y Usuario -->
        <div class="info-row">
          <div *ngIf="turnoAbierto">
          <label>Fecha: {{ turnoAbierto.FechaTrabajo| date: 'dd/MM/yyyy' }} </label>
        </div>
          <label>Usuario: {{ userLoged.username }}</label>
        </div>
      <!-- Botones en la parte superior derecha -->
      <div class="channel-buttons">
        <button  [disabled]="isCanalVentaDisabled">
          <fa-icon [icon]="faUtensils"></fa-icon> CANAL MESA
        </button>
        <button>
          <fa-icon [icon]="faShoppingBag"></fa-icon> CANAL LLEVAR
        </button>
        <button>
          <fa-icon [icon]="faTruck"></fa-icon> CANAL DELIVERY
        </button>
        <button (click)="Refresh()">
          <fa-icon [icon]="faSync"></fa-icon> REFRESH
        </button>
      </div>
    </div>
    <div class="middle-section">
      <div class="table-info">
        <label>Mesa Nº: {{ mesaSelected?.Descripcion + ' ' + mesaSelected?.Numero }}</label> 
        <label>Nº Pax: {{ mesaSelected?.NroPersonas }}</label> 
        <label>Mozo: {{ mozoSelected?.Nombre }}</label>
        <label>Hora: {{ horaPedido }}</label> 

        
      </div>
      <div #scrollContainer class="data-grid">
        <!-- <div  mat-table > -->
          <table mat-table [dataSource]="gridListaPedidoDetProducto">
            <ng-container matColumnDef="NombreProducto">
              <th mat-header-cell *matHeaderCellDef> Producto </th>
              <td mat-cell *matCellDef="let product" style="{{product.Item > 0 ? 'color: blue;': 'color: black;'}}">
                <table>
                  <tr>{{product.Producto.NombreCorto}}
                  </tr>
                  <tr *ngIf="product.Observacion" style="font-style: italic; font-size: small;">Observacion:
                    {{product.Observacion}}
                  </tr>
                  <tr *ngIf="product.Anfitriona" style="font-style: italic; font-size: small;">Anfitriona:
                    {{product.Anfitriona}}
                  </tr>
                  <tr *ngIf="product.NroCupon" style="font-style: italic; font-size: small;">NroCupon:
                    {{product.NroCupon}}
                  </tr>
                  <tr *ngIf="product.PedidoComplemento?.length" style="font-style: italic; font-size: small;">Con Complemento
                  </tr>
                </table>
              </td>
            </ng-container>

            <ng-container matColumnDef="Precio">
              <th mat-header-cell *matHeaderCellDef> Precio </th>
              <td mat-cell *matCellDef="let product" style="{{product.Item > 0 ? 'color: blue;': 'color: black;'}}">
                {{product.Precio}} </td>
            </ng-container>

            <ng-container matColumnDef="Cantidad">
              <th mat-header-cell *matHeaderCellDef> Qty </th>
              <td mat-cell *matCellDef="let product" style="{{product.Item > 0 ? 'color: blue;': 'color: black;'}}">
                {{product.Cantidad}} </td>
            </ng-container>


            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let product">
                <!-- <mat-icon>add</mat-icon>  -->
                <button mat-icon-button color="primary" matTooltip="Aumantar Cantidad"
                  (click)="aumentarProductGrid(product)" disabled="{{product.Item > 0 ? 'true': 'false'}}">
                  <mat-icon>add</mat-icon>
                </button>
                <button mat-icon-button color="warn" matTooltip="Restar Cantidad" (click)="restarProductGrid(product)"
                  disabled="{{product.Item > 0 ? 'true': 'false'}}">
                  <mat-icon>remove</mat-icon>
                </button>
                <button mat-icon-button color="primary" matTooltip="Mas Opciones" [matMenuTriggerFor]="MasOpciones">
                  <mat-icon>more</mat-icon>
                </button>
                <mat-menu #MasOpciones="matMenu">

                  <button mat-icon-button color="accent" matTooltip="Eliminar" (click)="deleteProductGrid(product)">
                    <mat-icon>delete</mat-icon>
                  </button>
                  <button mat-icon-button color="primary" matTooltip="Observacion"
                    (click)="openDialoObservaciones(product)" disabled="{{product.Item > 0 ? 'true': 'false'}}">
                    <mat-icon>event_note</mat-icon>
                  </button>
                  <button mat-icon-button color="primary" matTooltip="Anfitriona"  (click)="ingresarCodigosAnfitrionas(product)"  [disabled]="!product.Producto.ExclusivoParaAnfitriona || product.Item > 0">
                    <mat-icon>woman</mat-icon>
                  </button>
                  <button mat-icon-button color="primary" matTooltip="Trago Gratis"  (click)="ingresarCodigoCortesia(product)"  [disabled]="!product.Producto.PermitirParaTragoCortesia || product.Item > 0">
                    <mat-icon>local_bar</mat-icon>
                  </button>
                </mat-menu>
              </td>
            </ng-container>





            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="selectRow(row)" [class.selected-row]="selectedRow === row"></tr>
          </table>
          <!-- <mat-paginator [pageSizeOptions]="[6]" showFirstLastButtons></mat-paginator> -->
        </div>
      <!-- </div> -->
    </div>

    <!-- Tres filas estáticas debajo del datagridview -->
    <!-- Primera fila: Importe, Dscto, Total -->
    <div class="total-section">
      <label>Importe:</label><input type="text" readonly value={{sumaImporte}} />
      <label>Dscto:</label><input type="text" readonly  value={{sumaDscto}}/>
      <label>Total:</label><input type="text" readonly  value={{sumaTotal}}/>
      <input type="text" readonly value={{sumaImpuestoBolsa}}/>
    </div>

    <!-- Segunda fila: Combo, Ver Complemento, Priorizar Despacho, Enviar Pedido -->
   <!-- Primera fila de botones -->
<div class="button-row">
  <button [disabled]="isComboDisabled">
    <fa-icon [icon]="faConciergeBell"></fa-icon> Combo
  </button>
  <button [disabled]="isVerComplementoDisabled" (click)="VerPedido()">
    <fa-icon [icon]="faEye"></fa-icon> Ver Complemento
  </button>
  <button [disabled]="isPriorizarDespachoDisabled">
    <fa-icon [icon]="faList"></fa-icon> Priorizar Despacho
  </button>
  <button [disabled]="isEnviarPedidoDisabled" (click)="EnviarPedido()">
    <fa-icon [icon]="faPaperPlane"></fa-icon> Enviar Pedido
  </button>
</div>

<!-- Segunda fila de botones -->
<div class="button-row">
  <button [disabled]="isPrecuentaDisabled" (click)="ImprimirPrecuenta()">
    <fa-icon [icon]="faReceipt"></fa-icon> Precuenta
  </button>
  <button [disabled]="isAnularPedidoDisabled">
    <fa-icon [icon]="faTimes"></fa-icon> Anular Pedido
  </button>
  <button [disabled]="isReImprimirDisabled">
    <fa-icon [icon]="faReceipt"></fa-icon> ReImprimir
  </button>
  <button [disabled]="isBloquearDisabled" (click)="toggleBloquear()">
    <fa-icon [icon]="!procesarPedido ? faLock : faSync"></fa-icon> 
    {{ !procesarPedido ? 'Bloquear' : 'Rehacer' }}
  </button>
</div>

  </div>

  <!-- Segunda Columna -->
  <div class="column-right">
    <!-- Alterna entre las mesas y los productos -->
    <div *ngIf="MostrarOcultarPanelMesa" class="tables-grid">
      <button *ngFor="let mesa of ListaMesas_x_Ambiente"
        [style.background]="mesa.Color" 
        (click)="openDialogMesa(mesa)"
        [style.visibility]="mesa.Visible === false ? 'hidden' : 'visible'">
        <div style="text-align: center;">{{mesa.Descripcion}} {{mesa.Numero}} <br> S/.{{mesa.Total}} <br> {{mesa.NombreEmpleado.substring(0, 8)}}</div>
      </button>
    </div>

    <div *ngIf="MostrarOcultarPanelProducto" class="products-grid">
      <button *ngFor="let producto of listProducts_x_SubFamilia"  style="{{producto.Color}}"
      [style.visibility]="producto.Visible === 0 ? 'hidden' : 'visible'" (click)="AgregarProducto(producto)" [disabled]="isPanelProductoDisabled">
        <div style="text-align: center;"> {{producto.NombreCorto}} <br> S/.{{producto.Precio}}</div>
      </button>
    </div>

    <!-- Fila estática de botones (Barra, Salón, Box, Patio, Terraza) -->
    <div *ngIf="!procesarPedido">
      <div class="static-buttons-row">
        <button *ngFor="let item of listAmbiente"
        (click)="MostrarMesas_x_Ambiente(item)">{{item.Descripcion}}</button>
      </div>
  
      <!-- Segunda fila estática de botones con "Procesar Pedido" -->
      <div class="static-buttons-row">
        <button class="process-pedido" (click)="processPedido(false)">Procesar Pedido</button>
        <button>Cambiar Mesa</button>
        <button>Limpiar Mesa</button>
        <button>Activar Mesa</button>
      </div>
    </div>
    <div *ngIf="procesarPedido">
      <div class="static-buttons-row">
        
        <button *ngFor="let item of listFamilia"
        [ngClass]="{'selected': selectedItemFamilia === item}"   
        (click)="ListarSubFamilia_x_Familia(item)">
          {{item.Descripcion}}
        </button>
        <button>Buscar Productos</button>
      </div>
  
      <!-- Segunda fila estática de botones con "Procesar Pedido" -->
      <div class="static-buttons-row">

        <button  *ngFor="let item of listSubFamilia_x_Familia"   [ngClass]="{'selected': selectedItemSubFamilia === item}"   
        (click)="ListarProductos_x_SubFamilia(item)">{{item.Descripcion}}</button>

      </div>
    </div>

    
  </div>
</div>
